<tool id="PDAUG_Peptide_Data_Plotting" name="PDAUG_Peptide Data Plotting" version="0.1.0">
  <description>Creates various plots to analyze peptide data</description>

  <requirements>
    <requirement type="package" version="0.24.2">pandas</requirement>
    <requirement type="package" version="4.2.1">modlamp</requirement> 
  </requirements>
  <stdio>
    <exit_code range="1" level="fatal" />
  </stdio>
    <command detect_errors="exit_code"><![CDATA[


        python '$__tool_directory__/PDAUG_Peptide_Data_Plotting.py'  '$SelPlot.Plot'

            #if $SelPlot.Plot == 'HelWhl'
              --InFile $InFile
              --colorcoding $SelPlot.colorcoding
              --lineweights $SelPlot.lineweights
              --seq $SelPlot.seq
              --movment $SelPlot.movment 
            #end if 

            #if $SelPlot.Plot == 'PltPde'
              --InFile $InFile
              --ClmList $SelPlot.ClmList
              --Title $SelPlot.Title
              --axlabels $SelPlot.axlabels
              --legendloc $SelPlot.legendloc
              --x_min $SelPlot.x_min
              --x_max $SelPlot.x_max
              --alpha $SelPlot.alpha
            #end if 

            #if $SelPlot.Plot == 'PltVio'
              --InFile $InFile
              --ClmList $SelPlot.ClmList
              --title $SelPlot.title
              --axlabels $SelPlot.axlabels
              --y_min $SelPlot.y_min
              --y_max $SelPlot.y_max
            #end if 


            #if $SelPlot.Plot == 'PltAaDis'
              --InFile $InFile
            #end if 

            --htmlOutDir '$output2.extra_files_path'  --htmlFname '$output2'

                                   
    ]]></command>

  <inputs>

    <conditional name='SelPlot' >

        <param name="Plot" type="select" label="Plotting method" argument="">
          <option value="HelWhl">Helical wheel</option>
          <option value="PltPde">Probability density estimations</option>
          <option value="PltVio">Violin</option>
          <option value="PltAaDis">Amino acid distribution</option>
        </param>

        <when value="HelWhl">
            <param name="InFile" type="data" format="fasta" label="Input file" />
            <param name="colorcoding" type="text" value="rainbow" label="Color Coding" help="The color coding to be used, available: rainbow, charge, polar, simple, amphipathic, none." />
            <param name="lineweights" type="boolean" value="true" label="Line Weight" help="Defines whether connection lines decrease in thickness along the sequence." />
            <param name="seq" type="boolean" value="true" label="Sequence" help="Whether the amino acid sequence should be plotted as a title."/>
            <param name="movment"  type="boolean" value="false" label="Moment" help="Whether the Eisenberg hydrophobic moment should be calculated and plotted." />
        </when>

        <when value="PltPde">
            <param name="InFile" type="data" label="Input file"  format="tabular" />
            <param name="ClmList" type="text"  label="Column names" help="Enter the column name to be plotted"/>
            <param name="Title"  type="text" value="Plot" label="Plot title" help="Plot title"/>
            <param name="axlabels" type="text" label="X-label" help="List containing the axis labels for the plot" />
            <param name="legendloc" type="integer" value="2" label="Legend location" help="Location of the figures legend. 1 = top right, 2 = top left …"/>
            <param name="x_max" type="integer" value="1" label="x_max" help="x-axis maximum" />
            <param name="x_min" type="integer" value="0"  label="x_min" help="x-axis minimum"/>
            <param name="alpha" type="float" value="0.2" label="Alpha" help="Color alpha for filling pde curve" /> 
        </when>

        <when value="PltVio">
            <param name="InFile" type="data" format="tabular" argument= "--InFile"/>
            <param name="ClmList" type="text"  argument="--ClmList" />
            <param name="title"  type="text" value="Plot" argument="--Title"/>
            <param name="axlabels" type="text" argument="--axlabels" />
            <param name="y_max" type="integer" value="1" argument="--y_max" />
            <param name="y_min" type="integer" value="0" argument="--y_min" /> 
        </when>

        <when value="PltAaDis">
            <param name="InFile"  type="data" format="fasta" argument= "--seq_num"/>
        </when>

    </conditional>
  </inputs>

  <outputs>   
        <data name='output2' format='html' label="report.html" />
  </outputs>

  <tests>
    <test>
      <param name="Plot" value="PltPde"/>
      <param name="InFile"  value="test1.tsv"/>
      <param name="ClmList" value="a1,a2"/>
      <param name="Title" value="Plot"/>
      <param name="axlabels" value="fist_data_frame"/>
      <param name="legendloc" value="2"/>
      <param name="x_max" value="1"/>
      <param name="x_min" value="0"/>
      <param name="alpha" value="0.5" />
      <output name="output2" file="test1/report_dir/report.html"/>
    </test>
    <test>
      <param name="Plot" value="HelWhl"/>
      <param name="InFile"  value="test2.fasta"/>
      <param name="colorcoding" value="rainbow"/>
      <param name="lineweights" value="false"/>
      <param name="seq" value="false"/>
      <param name="movment" value="false"/>
      <output name="output2" file="test2/report_dir/report.html"/>
    </test>

    <test>
      <param name="Plot" value="PltVio"/>
      <param name="InFile"  value="test3.tsv"/>
      <param name="ClmList" value="a1,a2,a3,a4,a5"/>
      <param name="title" value="Plot"/>
      <param name="axlabels" value="jai"/>
      <param name="y_max" value="4"/>
      <param name="y_min" value="-4" />
      <output name="output2" file="test3/report_dir/report.html"/>
    </test>

    <test>
      <param name="Plot" value="PltAaDis"/>
      <param name="InFile"  value="test4.fasta"/>
      <output name="output2" file="test4/report_dir/report.html"/>
    </test>

  </tests>
    <help><![CDATA[
.. class:: infomark

**What it does**

This tool provided with some advance plotting functions for peptide data.

  * **Helical wheel** Generates a helical wheel projection plot of a given sequence.
  * **Probability density estimations** Generates a probability density estimation plot of given data arrays.
  * **Violin** Generates a violin plot for given classes and corresponding distributions.
  * **Amino acid distribution**  Generates an amino acid frequency plot for all 20 natural amino acids.


-----

**Inputs**
    **1** HelWhl
      * **--InFile** Input fasta file with peptide sequences. 
      * **----colorcoding**  the color coding to be used, available: rainbow, charge, polar, simple, amphipathic
      * **--lineweights** defines whether connection lines decrease in thickness along the sequence
      * **--seq** whether the amino acid sequence should be plotted as a title
      * **--movment** whether the Eisenberg hydrophobic moment should be calculated and plotted

    **2** PltPde
      * **--InFile**
      * **--ClmList** Listt of dataframe columns to be plotted. 
      * **--Title** Plot title.
      * **--axlabels** list containing the axis labels for the plot.
      * **--legendloc** location of the figures legend. 1 = top right, 2 = top left …
      * **--x_max**  x-axis minimum.
      * **--x_min**  x-axis maximum.
      * **--alpha** color alpha for filling pde curve.

    **3** PltVio
      * **--InFile** Input fasta file with peptide sequences. 
      * **--ClmList** List of data frame columns to be plotted. 
      * **--colors**  Face color of the violin plots, can also be a list of colors with the same dimension as x
      * **--bp** Print a box blot inside the violin.
      * **--title** Title of the plot.
      * **--axlabels** List containing the axis labels for the plot.
      * **--y_max** y-axis minimum.
      * **--y_min** y_max – {number} y-axis maximum.

    **4** PltAaDis
      * **--InFile** Input fasta file with peptide sequences.

-----

**Outputs**
    * **Helical wheel** Returns a helical wheel projection plot of the given sequence.
    * **Probability density estimations** Return probability density estimations plot of given data vectors 
    * **Violin** Returns violin plots out of the given data array.
    * **Amino acid distribution**  Returns amino acid distribution plot of a given list of sequences.]]></help>
<citations>
  <citation type="bibtex">
    @misc{PDAUGGITHUB, 
      author = {Joshi, Jayadev  and Blankenberg, Daniel}, 
      year = {2020}, 
      title ={PDAUG}, 
      publisher = {GitHub}, 
      journal = {GitHub repository}, 
      url =
      {https://github.com/jaidevjoshi83/Peptide}, 
    }
</citation>

<citation type="bibtex">
    @article{müller_gabernet_hiss_schneider_2017, 
      title={modlAMP: Python for antimicrobial peptides}, 
      volume={33}, 
      DOI={10.1093/bioinformatics/btx285}, 
      number={17}, 
      journal={Bioinformatics}, 
      author={Müller, Alex T and Gabernet, Gisela and Hiss, Jan A and Schneider, Gisbert}, 
      year={2017}, 
      pages={2753–2755}
    }
  </citation>
</citations>
</tool>
