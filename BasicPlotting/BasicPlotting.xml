<tool id="Basic_Plot" name="BasicPlotting" version="0.1.0" python_template_version="3.6">
  <description>Basic Plot</description>

  <requirements>
      <requirement type="package" version="0.25.3">pandas</requirement>
      <requirement type="package" version="4.10.0">plotly</requirement> 
      <requirement type="package" version="1.8.0">wordcloud</requirement>
      <requirement type="package" version="3.1.2">matplotlib</requirement>
  </requirements>
  <stdio>
    <exit_code range="1" level="fatal" />
  </stdio>
    <command detect_errors="exit_code"><![CDATA[


        python '$__tool_directory__/BasicPlotting.py'  '$SelPlotting.Plot' 

                #if $SelPlotting.Plot == 'HeatMap'
                    --InFile '$SelPlotting.InFile'
                    --IndexColumn '$SelPlotting.IndexColumn'
                    --x_label '$SelPlotting.x_label'
                    --y_label '$SelPlotting.y_label'
                #end if 

                #if $SelPlotting.Plot == 'BoxPlot'
                    --InFile '$SelPlotting.InFile'
                    --Feature '$SelPlotting.Feature'  
                    --Label '$SelPlotting.Label'           
                #end if 

                #if $SelPlotting.Plot == 'ScatterPlot'
                  --PlotType '$SelPlotting.PlotType.SelectPlot'
                    #if $SelPlotting.PlotType.SelectPlot == '2D'
                      -F1 '$SelPlotting.PlotType.Features1'
                      -F2 '$SelPlotting.PlotType.Features2'
                    #end if

                    #if $SelPlotting.PlotType.SelectPlot == '3D'
                      -F1 '$SelPlotting.PlotType.Features1'
                      -F2 '$SelPlotting.PlotType.Features2'
                      -F3 '$SelPlotting.PlotType.Features3'
                    #end if

                    -I '$SelPlotting.InFile' 
                    -L '$SelPlotting.Label'

                #end if 

                #if $SelPlotting.Plot == 'WordCloud'
                  -I '$SelPlotting.InFile'
                  -D '$SelPlotting.d'
                #end if 

                --htmlOutDir '$output.extra_files_path'
                --htmlFname '$output'
                      
    ]]></command>

  <inputs>

    <conditional name='SelPlotting' >

        <param name="Plot" type="select" label="Analysis options" argument="">
          <option value="HeatMap">HeatMap</option>
          <option value="BoxPlot">BoxPlot</option>
          <option value="ScatterPlot">ScatterPlot</option>
          <option value="WordCloud">WordCloud</option>
        </param>

        <when value="HeatMap">
            <param name="InFile" type="data" format="tabular" label="Input file" argument= "--InFile"/>
            <param name="IndexColumn" type="text" optional="true"  label="Index Column" argument= "--IndexColumn"/>
            <param name="x_label" type="text" optional="true"  label="Label for x-axis" argument= "--x_label"/>
            <param name="y_label" type="text" optional="true"  label="Label for y-axis" argument= "--y_label"/>
        </when>

        <when value="BoxPlot">
            <param name="InFile" type="data" format="fasta" argument= "--InFile"/>
            <param name="Feature" type="text" argument= "--Features"/>
            <param name="Label" type="text" argument="--Label" />
        </when>

        <when value="ScatterPlot">

          <param name="InFile"    type="data" format="fasta" argument= "--InFile"/>

          <conditional name='PlotType' >

              <param name="SelectPlot" type="select" label="Analysis options" argument="">
                  <option value="2D">2D</option>
                  <option value="3D">3D</option>
              </param>
              
              <when value="2D">
                <param name="Features1" type="text"    argument= "--RotationX"/>
                <param name="Features2" type="text"    argument= "--RotationY"/>
              </when>

              <when value="3D">
                <param name="Features1" type="text"    argument= "--RotationX"/>
                <param name="Features2" type="text"    argument= "--RotationY"/>
                <param name="Features3" type="text"    argument= "--FigHight"/>                 
              </when>

        </conditional>
          
          <param name="Label" type="text"  argument="--label" />

        </when>

        <when value="WordCloud" >
          <param name="InFile"  type="data" format="fasta" argument= "--InFile"/>
          <param name="d"  type="integer" value="4" argument= "--FragSize"/>
        </when>

    </conditional>
  </inputs>

  <outputs>
      <data name='output' format='html' label="report.html" > </data>
  </outputs>
  
  <tests>

    <test>
      <param name="Plot" value="HeatMap" />
      <param name="InFile" value="test1.tsv"/>
      <param name="IndexColumn" value="Algo"/>
      <param name="x_label" value="Performance"/>
      <param name="y_label" value="Algorithms"/>
      <output name="output" file="test1/report_dir/report.html.re" ftype="html" compare="re_match_multiline"/>
    </test>

    <test>
      <param name="Plot" value="BoxPlot" />
      <param name="InFile" value="test2.tsv"/>
      <param name="Feature" value="a1"/>
      <param name="Label" value="class"/>
      <output name="output" file="test2/report_dir/report.html.re" ftype="html" compare="re_match_multiline"/>
    </test>

    <test>
      <param name="Plot" value="ScatterPlot" />
      <param name="InFile" value="test2.tsv"/>
      <param name="SelectPlot" value="2D" />
      <param name="Features1" value="a1"/>
      <param name="Features2" value="a2"/>
      <param name="Label" value="class"/>
      <output name="output" file="test3/report_dir/report.html.re" ftype="html" compare="re_match_multiline"/>
    </test>

  <test>
    <param name="Plot" value="ScatterPlot" />
    <param name="SelectPlot" value="3D" />
    <param name="InFile" value="test2.tsv"/>
    <param name="Features1" value="a1"/>
    <param name="Features2" value="a2"/>
    <param name="Features3" value="a3"/>
    <param name="Label" value="class"/>
    <output name="output" file="test4/report_dir/report.html.re" ftype="html" compare="re_match_multiline"/>

  </test>

  <test>
      <param name="Plot" value="WordCloud" />
      <param name="InFile" value="positive.fasta"/>
      <param name="d" value="4" />
      <output name="output" file="test5/report_dir/report.html" ftype="html" />
  </test>

  </tests>
  
  <help>

  </help>

</tool>







