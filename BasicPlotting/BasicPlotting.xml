<tool id="Basic_Plot" name="BasicPlotting" version="0.1.0" python_template_version="3.6">>
  <description>Basic Plot</description>

  <requirements>
      <requirement type="package" version="3.3.0">matplotlib</requirement>
      <requirement type="package" version="0.25.3">pandas</requirement>
      <requirement type="package" version="0.9.0">seaborn</requirement> 
  </requirements>
  <stdio>
    <exit_code range="1" level="fatal" />
  </stdio>
    <command detect_errors="exit_code"><![CDATA[


        python '$__tool_directory__/BasicPlotting.py'  '$SelPlotting.Plot' 

                #if $SelPlotting.Plot == 'HeatMap'
                    --InFile '$SelPlotting.InFile'
                    --FigHight '$SelPlotting.FigHight'
                    --FigWidth '$SelPlotting.FigWidth'
                    --Rotation '$SelPlotting.Rotation'
                #end if 

                #if $SelPlotting.Plot == 'BoxPlot'
                    --InFile '$SelPlotting.InFile'
                    --RotationX '$SelPlotting.RotationX' 
                    --RotationY '$SelPlotting.RotationY'
                    --FigHight '$SelPlotting.FigHight'
                    --FigWidth '$SelPlotting.FigWidth'
                    --Features '$SelPlotting.Features'             
                #end if 

                #if $SelPlotting.Plot == 'ScatterPlot'
                  --PlotType '$SelPlotting.PlotType.SelectPlot'
                    #if $SelPlotting.PlotType.SelectPlot == '2D'
                      -F1 '$SelPlotting.PlotType.Features1'
                      -F2 '$SelPlotting.PlotType.Features2'
                    #end if

                    #if $SelPlotting.PlotType.SelectPlot == '3D'
                      -F1 '$SelPlotting.PlotType.Features1'
                      -F2 '$SelPlotting.PlotType.Features2'
                      -F3 '$SelPlotting.PlotType.Features3'
                    #end if

                    -I '$SelPlotting.InFile' 
                    -Rx '$SelPlotting.RotationX'
                    -Ry '$SelPlotting.RotationY'
                    -H '$SelPlotting.FigHight'
                    -W '$SelPlotting.FigWidth'
                    -L '$SelPlotting.Label'

                #end if 

                --htmlOutDir '$output.extra_files_path'
                --htmlFname '$output'
                      
    ]]></command>

  <inputs>

    <conditional name='SelPlotting' >

        <param name="Plot" type="select" label="Analysis options" argument="">
          <option value="HeatMap">HeatMap</option>
          <option value="BoxPlot">BoxPlot</option>
          <option value="ScatterPlot">ScatterPlot</option>
        </param>

        <when value="HeatMap">
            <param name="InFile" type="data" format="tabular" label="Input file" argument= "--InFile"/>
            <param name="FigHight" type="integer" optional="true"  label="Figure Hight" argument= "--FigWidth"/>
            <param name="FigWidth" type="integer" optional="true"  label="Figure Width" argument= "--FigHight"/>
            <param name="Rotation" type="integer" optional="true"  label="Rotation" argument= "--Rotation"/>
        </when>

        <when value="BoxPlot">
            <param name="InFile" type="data" format="fasta" argument= "--InFile"/>
            <param name="RotationX" optional="true"  type="integer" argument= "--RotationX"/>
            <param name="RotationY" optional="true"  type="integer" argument= "--RotationY"/>
            <param name="FigHight" optional="true" type="integer"  argument= "--FigHight"/>
            <param name="FigWidth" optional="true" type="integer"  argument= "--FigWidth"/>
            <param name="Features" type="text" argument= "--Features"/>
        </when>

        <when value="ScatterPlot">

          <param name="InFile"    type="data" format="fasta" argument= "--InFile"/>

          <conditional name='PlotType' >

              <param name="SelectPlot" type="select" label="Analysis options" argument="">
                  <option value="2D">2D</option>
                  <option value="3D">3D</option>
              </param>
              
              <when value="2D">
                <param name="Features1" type="text"    argument= "--RotationX"/>
                <param name="Features2" type="text"    argument= "--RotationY"/>
              </when>

              <when value="3D">
                <param name="Features1" type="text"    argument= "--RotationX"/>
                <param name="Features2" type="text"    argument= "--RotationY"/>
                <param name="Features3" type="text"    argument= "--FigHight"/>                 
              </when>

          </conditional>
          
          <param name="RotationX" type="integer"  optional="true"   argument= "--FigWidth"/>
          <param name="RotationY" type="integer"  optional="true"   argument= "--Features"/>
          <param name="FigHight"  type="integer"  optional="true"   argument= "--FigHight"/>
          <param name="FigWidth"  type="integer"  optional="true"   argument= "--FigWidth"/>
          <param name="Label"     type="text"                       argument="--label" />

        </when>

    </conditional>
  </inputs>

  <outputs>
      <data name='output' format='html' label="report.html" > </data>
  </outputs>
  
  <tests>
    <test>
      <param name="Plot" value="HeatMap" />
      <param name="InFile" value="test1.tsv"/>
      <param name="FigHight" value="10"/>
      <param name="FigWidth" value="12"/>
      <param name="Rotation" value="20" />
      <output name="output" file="test1/report_dir/report.html"/>
    </test>

    <test>
      <param name="Plot" value="BoxPlot" />
      <param name="InFile" value="test2.tsv"/>
      <param name="FigHight" value="10"/>
      <param name="FigWidth" value="12"/>
      <param name="RotationX" value="20" />
      <param name="RotationY" value="20" />
      <param namee="Features" value="a1,a2"/>
      <output name="output" file="test2/report_dir/report.html"/>
    </test>

    <test>
      <param name="Plot" value="ScatterPlot" />
      <param name="SelectPlot" value="2D" />
      <param name="InFile" value="test3.tsv"/>
      <param name="FigHight" value="10"/>
      <param name="FigWidth" value="12"/>
      <param name="RotationX" value="20" />
      <param name="RotationY" value="20" />
      <param name="Label" value="class" />
      <param namee="Features1" value="a1"/>
      <param namee="Features2" value="a2"/>
      <output name="output" file="test3/report_dir/report.html"/>
    </test>

    <test>
      <param name="Plot" value="ScatterPlot" />
      <param name="SelectPlot" value="3D" />
      <param name="InFile" value="test4.tsv"/>
      <param name="FigHight" value="10"/>
      <param name="FigWidth" value="12"/>
      <param name="RotationX" value="20" />
      <param name="RotationY" value="20" />
      <param name="Label" value="class" />
      <param namee="Features1" value="a1"/>
      <param namee="Features2" value="a2"/>
      <param namee="Features3" value="a3"/>     
      <output name="output" file="test4/report_dir/report.html"/>
    </test>

  </tests>
  <help>

  </help>
</tool>







